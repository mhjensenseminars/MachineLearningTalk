<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html sensing.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=sensing-bs --no_mako
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Making sense of sensing?">
<title>Making sense of sensing?</title>
<!-- Bootstrap style: bootstrap -->
<!-- doconce format html sensing.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=sensing-bs --no_mako -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Motivation and Content', 2, None, 'motivation-and-content'),
              ('More material will be added',
               2,
               None,
               'more-material-will-be-added'),
              ('Literature', 2, None, 'literature'),
              ('One-qubit system', 2, None, 'one-qubit-system'),
              ('Definitions: Single qubit gates',
               2,
               None,
               'definitions-single-qubit-gates'),
              ('Pauli-$\\boldsymbol{X}$ gate',
               2,
               None,
               'pauli-boldsymbol-x-gate'),
              ('Hadamard gate', 2, None, 'hadamard-gate'),
              ('Sensing Hamiltonian', 2, None, 'sensing-hamiltonian'),
              ('Time-dependent Hamiltonian matrix',
               2,
               None,
               'time-dependent-hamiltonian-matrix'),
              ('Interaction part', 2, None, 'interaction-part'),
              ('Non-interacting solution', 2, None, 'non-interacting-solution'),
              ('Rewriting with Pauli matrices',
               2,
               None,
               'rewriting-with-pauli-matrices'),
              ('Simple time dependence', 2, None, 'simple-time-dependence'),
              ('Exact solution', 2, None, 'exact-solution'),
              ('Selecting parameters', 2, None, 'selecting-parameters'),
              ('Setting up the matrix for the simple one-qubit system',
               2,
               None,
               'setting-up-the-matrix-for-the-simple-one-qubit-system'),
              ('Sensing protocol', 2, None, 'sensing-protocol'),
              ('Initialization and sensing analysis, Ramsey measurement',
               2,
               None,
               'initialization-and-sensing-analysis-ramsey-measurement'),
              ('Effects of stimulus', 2, None, 'effects-of-stimulus'),
              ('Slowly changing potential',
               2,
               None,
               'slowly-changing-potential'),
              ('Readout', 2, None, 'readout'),
              ('Measurement', 2, None, 'measurement'),
              ('Multiple measurements', 2, None, 'multiple-measurements'),
              ('Example', 2, None, 'example'),
              ('Evolution of initial state',
               2,
               None,
               'evolution-of-initial-state'),
              ('State evolution', 2, None, 'state-evolution'),
              ('Preparing for readout', 2, None, 'preparing-for-readout'),
              ('Transition probability', 2, None, 'transition-probability'),
              ('"Ramsey '
               'interferometry":"https://en.wikipedia.org/wiki/Ramsey_interferometry"',
               2,
               None,
               'ramsey-interferometry-https-en-wikipedia-org-wiki-ramsey-interferometry'),
              ('Benefits of Entanglement', 2, None, 'benefits-of-entanglement'),
              ('Ramsey interferometry', 2, None, 'ramsey-interferometry'),
              ('More than one qubit', 2, None, 'more-than-one-qubit'),
              ('After initialization', 2, None, 'after-initialization'),
              ('Transition probability', 2, None, 'transition-probability'),
              ('Role of entanglement', 2, None, 'role-of-entanglement'),
              ('Moving on to other systems',
               2,
               None,
               'moving-on-to-other-systems'),
              ('Simple system to lllustrate entanglement',
               2,
               None,
               'simple-system-to-lllustrate-entanglement'),
              ('Computational basis states',
               2,
               None,
               'computational-basis-states'),
              ('Eigenstates of non-interacting Hamiltonian',
               2,
               None,
               'eigenstates-of-non-interacting-hamiltonian'),
              ('Interaction part', 2, None, 'interaction-part'),
              ('Density matrices', 2, None, 'density-matrices'),
              ('Subsystems', 2, None, 'subsystems'),
              ('Entropies', 2, None, 'entropies'),
              ('Understanding the example',
               2,
               None,
               'understanding-the-example'),
              ('Code, best seen in jupyter-notebook',
               2,
               None,
               'code-best-seen-in-jupyter-notebook'),
              ('More material to come', 2, None, 'more-material-to-come')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="sensing-bs.html">Making sense of sensing?</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._sensing-bs001.html#motivation-and-content" style="font-size: 80%;">Motivation and Content</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs002.html#more-material-will-be-added" style="font-size: 80%;">More material will be added</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs003.html#literature" style="font-size: 80%;">Literature</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs004.html#one-qubit-system" style="font-size: 80%;">One-qubit system</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs005.html#definitions-single-qubit-gates" style="font-size: 80%;">Definitions: Single qubit gates</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs006.html#pauli-boldsymbol-x-gate" style="font-size: 80%;">Pauli-\( \boldsymbol{X} \) gate</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs007.html#hadamard-gate" style="font-size: 80%;">Hadamard gate</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs008.html#sensing-hamiltonian" style="font-size: 80%;">Sensing Hamiltonian</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs009.html#time-dependent-hamiltonian-matrix" style="font-size: 80%;">Time-dependent Hamiltonian matrix</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs040.html#interaction-part" style="font-size: 80%;">Interaction part</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs011.html#non-interacting-solution" style="font-size: 80%;">Non-interacting solution</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs012.html#rewriting-with-pauli-matrices" style="font-size: 80%;">Rewriting with Pauli matrices</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs013.html#simple-time-dependence" style="font-size: 80%;">Simple time dependence</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs014.html#exact-solution" style="font-size: 80%;">Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs015.html#selecting-parameters" style="font-size: 80%;">Selecting parameters</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs016.html#setting-up-the-matrix-for-the-simple-one-qubit-system" style="font-size: 80%;">Setting up the matrix for the simple one-qubit system</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs017.html#sensing-protocol" style="font-size: 80%;">Sensing protocol</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs018.html#initialization-and-sensing-analysis-ramsey-measurement" style="font-size: 80%;">Initialization and sensing analysis, Ramsey measurement</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs019.html#effects-of-stimulus" style="font-size: 80%;">Effects of stimulus</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs020.html#slowly-changing-potential" style="font-size: 80%;">Slowly changing potential</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs021.html#readout" style="font-size: 80%;">Readout</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs022.html#measurement" style="font-size: 80%;">Measurement</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs023.html#multiple-measurements" style="font-size: 80%;">Multiple measurements</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs024.html#example" style="font-size: 80%;">Example</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs025.html#evolution-of-initial-state" style="font-size: 80%;">Evolution of initial state</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs026.html#state-evolution" style="font-size: 80%;">State evolution</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs027.html#preparing-for-readout" style="font-size: 80%;">Preparing for readout</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs034.html#transition-probability" style="font-size: 80%;">Transition probability</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs029.html#ramsey-interferometry-https-en-wikipedia-org-wiki-ramsey-interferometry" style="font-size: 80%;">"Ramsey interferometry":"https://en.wikipedia.org/wiki/Ramsey_interferometry"</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs030.html#benefits-of-entanglement" style="font-size: 80%;">Benefits of Entanglement</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs031.html#ramsey-interferometry" style="font-size: 80%;">Ramsey interferometry</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs032.html#more-than-one-qubit" style="font-size: 80%;">More than one qubit</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs033.html#after-initialization" style="font-size: 80%;">After initialization</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs034.html#transition-probability" style="font-size: 80%;">Transition probability</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs035.html#role-of-entanglement" style="font-size: 80%;">Role of entanglement</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs036.html#moving-on-to-other-systems" style="font-size: 80%;">Moving on to other systems</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs037.html#simple-system-to-lllustrate-entanglement" style="font-size: 80%;">Simple system to lllustrate entanglement</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs038.html#computational-basis-states" style="font-size: 80%;">Computational basis states</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs039.html#eigenstates-of-non-interacting-hamiltonian" style="font-size: 80%;">Eigenstates of non-interacting Hamiltonian</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs040.html#interaction-part" style="font-size: 80%;">Interaction part</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs041.html#density-matrices" style="font-size: 80%;">Density matrices</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs042.html#subsystems" style="font-size: 80%;">Subsystems</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs043.html#entropies" style="font-size: 80%;">Entropies</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs044.html#understanding-the-example" style="font-size: 80%;">Understanding the example</a></li>
     <!-- navigation toc: --> <li><a href="#code-best-seen-in-jupyter-notebook" style="font-size: 80%;">Code, best seen in jupyter-notebook</a></li>
     <!-- navigation toc: --> <li><a href="._sensing-bs046.html#more-material-to-come" style="font-size: 80%;">More material to come</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0045"></a>
<!-- !split -->
<h2 id="code-best-seen-in-jupyter-notebook" class="anchor">Code, best seen in jupyter-notebook </h2>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #666666">%</span>matplotlib inline
<span style="color: #008000; font-weight: bold">from</span>  <span style="color: #0000FF; font-weight: bold">matplotlib</span> <span style="color: #008000; font-weight: bold">import</span> pyplot <span style="color: #008000; font-weight: bold">as</span> plt
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scipy.linalg</span> <span style="color: #008000; font-weight: bold">import</span> logm, expm
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">log2M</span>(a): <span style="color: #408080; font-style: italic"># base 2 matrix logarithm</span>
    <span style="color: #008000; font-weight: bold">return</span> logm(a)<span style="color: #666666">/</span>np<span style="color: #666666">.</span>log(<span style="color: #666666">2.0</span>)

dim <span style="color: #666666">=</span> <span style="color: #666666">4</span>
Hamiltonian <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((dim,dim))
<span style="color: #408080; font-style: italic">#number of lambda values</span>
n <span style="color: #666666">=</span> <span style="color: #666666">40</span>
lmbd <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0.0</span>,<span style="color: #666666">1.0</span>,n)
Hx <span style="color: #666666">=</span> <span style="color: #666666">2.0</span>
Hz <span style="color: #666666">=</span> <span style="color: #666666">3.0</span>
<span style="color: #408080; font-style: italic"># Non-diagonal part as sigma_x tensor product with sigma_x</span>
sx <span style="color: #666666">=</span> np<span style="color: #666666">.</span>matrix([[<span style="color: #666666">0</span>,<span style="color: #666666">1</span>],[<span style="color: #666666">1</span>,<span style="color: #666666">0</span>]])
sx2 <span style="color: #666666">=</span> Hx<span style="color: #666666">*</span>np<span style="color: #666666">.</span>kron(sx, sx)
<span style="color: #408080; font-style: italic"># Diagonal part as sigma_z tensor product with sigma_z</span>
sz <span style="color: #666666">=</span> np<span style="color: #666666">.</span>matrix([[<span style="color: #666666">1</span>,<span style="color: #666666">0</span>],[<span style="color: #666666">0</span>,<span style="color: #666666">-1</span>]])
sz2 <span style="color: #666666">=</span> Hz<span style="color: #666666">*</span>np<span style="color: #666666">.</span>kron(sz, sz)
noninteracting <span style="color: #666666">=</span> [<span style="color: #666666">0.0</span>, <span style="color: #666666">2.5</span>, <span style="color: #666666">6.5</span>, <span style="color: #666666">7.0</span>]
D <span style="color: #666666">=</span> np<span style="color: #666666">.</span>diag(noninteracting)
Eigenvalue <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((dim,n))
Entropy <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n)

<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(n): 
    Hamiltonian <span style="color: #666666">=</span> lmbd[i]<span style="color: #666666">*</span>(sx2<span style="color: #666666">+</span>sz2)<span style="color: #666666">+</span>D
    <span style="color: #408080; font-style: italic"># diagonalize and obtain eigenvalues, not necessarily sorted</span>
    EigValues, EigVectors <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>eig(Hamiltonian)
    <span style="color: #408080; font-style: italic"># sort eigenvectors and eigenvalues</span>
    permute <span style="color: #666666">=</span> EigValues<span style="color: #666666">.</span>argsort()
    EigValues <span style="color: #666666">=</span> EigValues[permute]
    EigVectors <span style="color: #666666">=</span> EigVectors[:,permute]
    <span style="color: #408080; font-style: italic"># Compute density matrix for selected system state, here ground state</span>
    DensityMatrix <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((dim,dim))
    DensityMatrix <span style="color: #666666">=</span> np<span style="color: #666666">.</span>outer(EigVectors[:,<span style="color: #666666">0</span>],EigVectors[:,<span style="color: #666666">0</span>])
    <span style="color: #408080; font-style: italic"># Project down on substates and find density matrix for subsystem</span>
    d <span style="color: #666666">=</span> np<span style="color: #666666">.</span>matrix([[<span style="color: #666666">1</span>,<span style="color: #666666">0</span>],[<span style="color: #666666">0</span>,<span style="color: #666666">1</span>]])
    v1 <span style="color: #666666">=</span> [<span style="color: #666666">1.0</span>,<span style="color: #666666">0.0</span>]
    proj1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>kron(v1,d)
    x1 <span style="color: #666666">=</span> proj1 <span style="color: #666666">@</span> DensityMatrix <span style="color: #666666">@</span> proj1<span style="color: #666666">.</span>T
    v2 <span style="color: #666666">=</span> [<span style="color: #666666">0.0</span>,<span style="color: #666666">1.0</span>]
    proj2 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>kron(v2,d)
    x2 <span style="color: #666666">=</span> proj2 <span style="color: #666666">@</span> DensityMatrix <span style="color: #666666">@</span> proj2<span style="color: #666666">.</span>T
    <span style="color: #408080; font-style: italic"># Total density matrix for subsystem</span>
    total <span style="color: #666666">=</span> x1<span style="color: #666666">+</span>x2
    <span style="color: #408080; font-style: italic"># von Neumann Entropy for subsystem </span>
    Entropy[i] <span style="color: #666666">=</span> <span style="color: #666666">-</span>np<span style="color: #666666">.</span>matrix<span style="color: #666666">.</span>trace(total <span style="color: #666666">@</span> log2M(total))
    <span style="color: #408080; font-style: italic"># Plotting eigenvalues and entropy as functions of interaction strengths</span>
    Eigenvalue[<span style="color: #666666">0</span>,i] <span style="color: #666666">=</span> EigValues[<span style="color: #666666">0</span>]
    Eigenvalue[<span style="color: #666666">1</span>,i] <span style="color: #666666">=</span> EigValues[<span style="color: #666666">1</span>]
    Eigenvalue[<span style="color: #666666">2</span>,i] <span style="color: #666666">=</span> EigValues[<span style="color: #666666">2</span>]
    Eigenvalue[<span style="color: #666666">3</span>,i] <span style="color: #666666">=</span> EigValues[<span style="color: #666666">3</span>]
plt<span style="color: #666666">.</span>plot(lmbd, Eigenvalue[<span style="color: #666666">0</span>,:] ,<span style="color: #BA2121">&#39;b-&#39;</span>,lmbd, Eigenvalue[<span style="color: #666666">1</span>,:],<span style="color: #BA2121">&#39;g-&#39;</span>,)
plt<span style="color: #666666">.</span>plot(lmbd, Eigenvalue[<span style="color: #666666">2</span>,:] ,<span style="color: #BA2121">&#39;r-&#39;</span>,lmbd, Eigenvalue[<span style="color: #666666">3</span>,:],<span style="color: #BA2121">&#39;y-&#39;</span>,)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;$\lambda$&#39;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;Eigenvalues&#39;</span>)
plt<span style="color: #666666">.</span>show()
plt<span style="color: #666666">.</span>plot(lmbd, Entropy)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;$\lambda$&#39;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;Entropy&#39;</span>)          
plt<span style="color: #666666">.</span>show
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._sensing-bs044.html">&laquo;</a></li>
  <li><a href="._sensing-bs000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._sensing-bs037.html">38</a></li>
  <li><a href="._sensing-bs038.html">39</a></li>
  <li><a href="._sensing-bs039.html">40</a></li>
  <li><a href="._sensing-bs040.html">41</a></li>
  <li><a href="._sensing-bs041.html">42</a></li>
  <li><a href="._sensing-bs042.html">43</a></li>
  <li><a href="._sensing-bs043.html">44</a></li>
  <li><a href="._sensing-bs044.html">45</a></li>
  <li class="active"><a href="._sensing-bs045.html">46</a></li>
  <li><a href="._sensing-bs046.html">47</a></li>
  <li><a href="._sensing-bs046.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>
</body>
</html>

